{% load i18n %}
{% load heroicons %}
<nav class="sticky top-0 z-50 border-b"
     style="background-color: var(--theme-bg-secondary);
            border-color: var(--theme-border)">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-14">
            <div class="flex items-center">
                <a href="{{ request.scheme }}://{{ current_site.domain }}{% url 'web:index' %}"
                   class="flex items-center space-x-2">
                    <svg viewBox="0 0 100 100"
                         fill="none"
                         xmlns="http://www.w3.org/2000/svg"
                         class="size-8">
                        <path d="M50 50 L6.7 25 L50 0 L93.3 25 L50 50" fill="#262626" />
                        <path d="M50 50 L50 100 L6.7 75 L6.7 25 L50 50" fill="#1A1A1A" />
                        <path d="M50 50 L93.3 25 L93.3 75 L50 100 L50 50" fill="#F05537" />
                    </svg>
                    <span class="text-xl font-semibold tracking-tight hidden sm:inline">
                        <span class="text-neutral-800 dark:text-neutral-200">{{ current_sphere.name }}</span>
                    </span>
                </a>
            </div>
            <div class="flex items-center">
                {% if request.user.is_authenticated %}
                    <!-- User dropdown menu -->
                    <div class="relative group">
                        <!-- Avatar trigger -->
                        <button type="button"
                                class="w-9 h-9 rounded-full bg-neutral-800 flex items-center justify-center cursor-pointer transition-all duration-150 ring-2 ring-transparent hover:ring-coral-500/30 focus:outline-none focus:ring-coral-500/50"
                                aria-haspopup="true"
                                aria-expanded="false">
                            <span class="text-sm text-white font-semibold tracking-tight">
                                {{ request.user.full_name|default:request.user.email|slice:":2"|upper }}
                            </span>
                        </button>
                        <!-- Dropdown panel -->
                        <div class="absolute right-0 top-full pt-2 opacity-0 invisible translate-y-1 group-hover:opacity-100 group-hover:visible group-hover:translate-y-0 group-focus-within:opacity-100 group-focus-within:visible group-focus-within:translate-y-0 transition-all duration-150 ease-out z-50">
                            <div class="w-48 rounded-lg shadow-lg border overflow-hidden"
                                 style="background-color: var(--theme-bg-secondary);
                                        border-color: var(--theme-border);
                                        box-shadow: 0 10px 40px -10px rgba(0,0,0,0.15)">
                                <!-- User info header -->
                                <div class="px-3.5 py-2.5 border-b"
                                     style="border-color: var(--theme-border)">
                                    <p class="text-sm font-medium truncate"
                                       style="color: var(--color-foreground)">
                                        {{ request.user.full_name|default:"User" }}
                                    </p>
                                    <p class="text-xs truncate mt-0.5"
                                       style="color: var(--color-foreground-secondary)">{{ request.user.email }}</p>
                                </div>
                                {% if is_sphere_manager %}
                                    <a href="{% url 'panel:index' %}"
                                       class="flex items-center gap-1.5 px-3.5 py-3 text-sm transition-colors duration-150 hover:bg-coral-50 dark:hover:bg-coral-950/20"
                                       style="color: var(--color-foreground-secondary)">
                                        {% heroicon_outline "squares-2x2" class="w-4 h-4 opacity-60" %}
                                        {% translate "Panel" %}
                                    </a>
                                {% endif %}
                                <a href="{% url 'web:crowd:profile' %}"
                                   class="flex items-center gap-1.5 px-3.5 py-3 text-sm transition-colors duration-150 hover:bg-coral-50 dark:hover:bg-coral-950/20"
                                   style="color: var(--color-foreground-secondary)">
                                    {% heroicon_outline "user-circle" class="w-4 h-4 opacity-60" %}
                                    {% translate "Edit profile" %}
                                </a>
                                <a href="{% url 'web:crowd:auth0:logout' %}"
                                   class="flex items-center gap-1.5 px-3.5 py-3 text-sm border-t transition-colors duration-150 hover:bg-coral-50 dark:hover:bg-coral-950/20"
                                   style="color: var(--color-foreground-secondary);
                                          border-color: var(--theme-border)">
                                    {% heroicon_outline "arrow-right-on-rectangle" class="w-4 h-4 opacity-60" %}
                                    {% translate "Log out" %}
                                </a>
                            </div>
                        </div>
                    </div>
                {% else %}
                    {% include "components/login_button.html" with next=request.build_absolute_uri extra_class="text-sm" show_icon="" text="" %}
                {% endif %}
            </div>
        </div>
    </div>
</nav>
