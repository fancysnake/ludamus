{% load avatar_tags %}
{# Reusable avatar: expects "user" (UserDTO/User) and optional "size" #}
{% with size_class=size|default:"size-8" border_class="border border-white/80 dark:border-neutral-900" %}
    {% if user %}
        {% with name_value=user.full_name|default:user.name|default:user.username|default:"" %}
            <div class="{{ size_class }} {{ border_class }} rounded-full shrink-0 relative overflow-hidden">
                <div class="absolute inset-0 {{ name_value|avatar_bg_class }} flex items-center justify-center">
                    <span class="text-xs font-semibold text-white">{{ name_value|slice:":2"|upper }}</span>
                </div>
                {% if user.avatar_url %}
                    <img src="{{ user.avatar_url }}"
                         alt="{{ name_value }}"
                         width="32"
                         height="32"
                         class="absolute inset-0 h-full w-full object-cover"
                         loading="lazy">
                {% endif %}
            </div>
        {% endwith %}
    {% endif %}
{% endwith %}
