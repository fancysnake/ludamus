{% load i18n %}
{% load static %}
{% load heroicons %}
{% get_current_language as LANGUAGE_CODE %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description"
              content="{% block meta_description %}Event webapp{% endblock meta_description %}">
        <meta name="keywords"
              content="events, conferences, workshops, seminars, meetups, registration, enrollment, sessions, networking, professional development, tech events, design workshops, free events">
        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="{{ request.build_absolute_uri }}">
        <meta property="og:title"
              content="{% block og_title %}{{ current_sphere.name }}{% endblock og_title %}">
        <meta property="og:description"
              content="{% block og_description %}Event webapp{% endblock og_description %}">
        <meta property="og:image"
              content="{% block og_image %}https://zagrajmy.net/static/logo.png{% endblock og_image %}">
        <meta property="og:site_name" content="{{ current_sphere.name }}">
        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title"
              content="{% block twitter_title %}{{ current_sphere.name }}{% endblock twitter_title %}">
        <meta name="twitter:description"
              content="{% block twitter_description %}Event webapp{% endblock twitter_description %}">
        <meta name="twitter:image"
              content="{% block twitter_image %}https://zagrajmy.net/static/logo.png{% endblock twitter_image %}">
        <title>
            {% block title %}
                {{ current_sphere.name }}
            {% endblock title %}
        </title>
        <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
        <link rel="shortcut icon"
              type="image/x-icon"
              href="{% static 'favicon.ico' %}">
        <!-- Theme initialization (before CSS to prevent flash) -->
        <script>
            (function() {
                var theme = localStorage.getItem('theme');
                if (theme === 'light') {
                    document.documentElement.classList.add('light');
                } else if (theme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                }
            })();
        </script>
        <!-- Tailwind CSS (compiled) -->
        <link rel="stylesheet"
              href="{% static 'css/output.css' %}?v={{ STATIC_VERSION }}">
        <style>
            /* Card accent line */
            .card-accent {
                position: relative;
            }

            .card-accent::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                height: 3px;
                background: var(--theme-accent-gradient, linear-gradient(90deg, #d97706, #f59e0b, #d97706));
            }

            /* Card shadow */
            .card-shadow {
                box-shadow: var(--theme-shadow, 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.06));
            }

            .card-shadow:hover {
                box-shadow: var(--theme-shadow-md, 0 4px 6px rgba(0, 0, 0, 0.07), 0 2px 4px rgba(0, 0, 0, 0.05));
            }

            /* Corner mark decoration */
            .corner-mark {
                position: relative;
            }

            .corner-mark::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 12px;
                height: 12px;
                border-left: 2px solid #d97706;
                border-top: 2px solid #d97706;
            }

            .corner-mark::after {
                content: '';
                position: absolute;
                bottom: 0;
                right: 0;
                width: 12px;
                height: 12px;
                border-right: 2px solid #d97706;
                border-bottom: 2px solid #d97706;
            }
        </style>
        {% block extra_head %}
        {% endblock extra_head %}
    </head>
    <body class="flex flex-col min-h-screen font-sans antialiased bg-background text-foreground">
        {% include "components/navbar.html" %}
        <!-- Flash Messages -->
        {% if messages %}
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pt-4 space-y-2">
                {% for message in messages %}
                    <div class="p-4 rounded-lg flex items-start {% if message.tags == 'error' %}border{% elif message.tags == 'warning' %}border{% elif message.tags == 'success' %}border{% elif message.tags == 'info' %}border{% else %}border{% endif %}"
                         style="{% if message.tags == 'error' %}background-color: var(--theme-danger-bg);
                                border-color: var(--theme-danger-light);
                                color: var(--theme-danger-text);
                                {% elif message.tags == 'warning' %}background-color: var(--theme-warning-bg);
                                border-color: var(--theme-warning-light);
                                color: var(--theme-warning-text);
                                {% elif message.tags == 'success' %}background-color: var(--theme-success-bg);
                                border-color: var(--theme-success-light);
                                color: var(--theme-success-text);
                                {% elif message.tags == 'info' %}background-color: var(--theme-info-bg);
                                border-color: var(--theme-info-light);
                                color: var(--theme-info-text);
                                {% else %}background-color: var(--theme-bg-tertiary);
                                border-color: var(--theme-border);
                                color: var(--color-foreground-secondary);
                                {% endif %}">
                        {% if message.tags == 'error' %}
                            {% heroicon_outline "exclamation-triangle" class="w-5 h-5 mr-3 flex-shrink-0" %}
                        {% elif message.tags == 'warning' %}
                            {% heroicon_outline "exclamation-triangle" class="w-5 h-5 mr-3 flex-shrink-0" %}
                        {% elif message.tags == 'success' %}
                            {% heroicon_outline "check-circle" class="w-5 h-5 mr-3 flex-shrink-0" %}
                        {% elif message.tags == 'info' %}
                            {% heroicon_outline "information-circle" class="w-5 h-5 mr-3 flex-shrink-0" %}
                        {% else %}
                            {% heroicon_outline "chat-bubble-left-ellipsis" class="w-5 h-5 mr-3 flex-shrink-0" %}
                        {% endif %}
                        <span class="text-sm">{{ message }}</span>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
        <!-- Main Content -->
        <main class="grow flex flex-col max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 w-full">
            <!-- Page Header -->
            {% block header_section %}
                <div class="mb-6 text-center">
                    <h1 class="text-2xl sm:text-3xl font-bold"
                        style="color: var(--color-foreground)">
                        {% block header %}
                        {% endblock header %}
                    </h1>
                    {% block description %}
                        <p class="mt-2 text-sm sm:text-base"
                           style="color: var(--color-foreground-muted)">
                            {% block description_text %}
                            {% endblock description_text %}
                        </p>
                    {% endblock description %}
                </div>
            {% endblock header_section %}
            {% block body %}
            {% endblock body %}
        </main>
        <!-- Footer -->
        <footer class="border-t py-6 mt-8"
                style="background-color: var(--theme-bg-secondary);
                       border-color: var(--theme-border)">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-end mb-4">{% include "components/theme_switcher.html" %}</div>
                <div class="flex flex-col sm:flex-row justify-between items-center gap-4 text-sm"
                     style="color: var(--color-foreground-muted)">
                    <p class="text-center sm:text-left">
                        © {% now "Y" %} Radosław Ganczarek.
                        <a href="https://github.com/fancysnake/ludamus"
                           class="hover:underline"
                           style="color: var(--theme-primary)">Source code</a>
                        available under BSD-3-Clause license.
                    </p>
                    <div class="flex flex-wrap justify-center sm:justify-end gap-4">
                        <a href="mailto:{{ SUPPORT_EMAIL }}"
                           class="hover:underline"
                           style="color: var(--theme-primary)">{% translate "Contact" %}</a>
                        <a href="{% url 'django.contrib.flatpages.views.flatpage' url='/privacy-policy/' %}"
                           class="hover:underline"
                           style="color: var(--theme-primary)">{% translate "Privacy Policy" %}</a>
                        <a href="{% url 'django.contrib.flatpages.views.flatpage' url='/terms-of-service/' %}"
                           class="hover:underline"
                           style="color: var(--theme-primary)">{% translate "Terms of Service" %}</a>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Scripts -->
        <script src="{% static 'vendor/htmx.min.js' %}"></script>
        {% include "components/theme_script.html" %}
        {% block extra_scripts %}
        {% endblock extra_scripts %}
    </body>
</html>
