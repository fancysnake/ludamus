{% load i18n %}
{% load django_bootstrap5 %}
{% load static %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE }}">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description"
              content="{% block meta_description %}Event webapp{% endblock meta_description %}">
        <meta name="keywords"
              content="events, conferences, workshops, seminars, meetups, registration, enrollment, sessions, networking, professional development, tech events, design workshops, free events">
        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website">
        <meta property="og:url" content="{{ request.build_absolute_uri }}">
        <meta property="og:title"
              content="{% block og_title %}{{ current_sphere.name }}{% endblock og_title %}">
        <meta property="og:description"
              content="{% block og_description %}Event webapp{% endblock og_description %}">
        <meta property="og:image"
              content="{% block og_image %}https://zagrajmy.net/static/logo.png{% endblock og_image %}">
        <meta property="og:site_name" content="{{ current_sphere.name }}">
        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title"
              content="{% block twitter_title %}{{ current_sphere.name }}{% endblock twitter_title %}">
        <meta name="twitter:description"
              content="{% block twitter_description %}Event webapp{% endblock twitter_description %}">
        <meta name="twitter:image"
              content="{% block twitter_image %}https://zagrajmy.net/static/logo.png{% endblock twitter_image %}">
        <title>
            {% block title %}
            {% endblock title %}
        </title>
        <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
        <link rel="shortcut icon"
              type="image/x-icon"
              href="{% static 'favicon.ico' %}">
        <link rel="stylesheet" href="{% static 'vendor/bootstrap.min.css' %}">
        <link rel="stylesheet" href="{% static 'vendor/bootstrap-icons.min.css' %}">
        <link rel="stylesheet" href="{% static 'css/common.css' %}">
    </head>
    <body>
        <nav class="navbar navbar-expand navbar-dark bg-primary">
            <a class="navbar-brand fw-bold"
               href="{{ request.scheme }}://{{ current_site.domain }}{% url 'web:index' %}">
                <i class="bi bi-people"></i> {{ current_sphere.name }}
            </a>
            <div class="navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    {% if request.user.is_authenticated and request.user.full_name %}
                        <li class="nav-item">
                            <span class="navbar-text text-light me-3">
                                <i class="bi bi-person-circle"></i>
                                {{ request.user.full_name }}
                            </span>
                        </li>
                    {% endif %}
                    {% if request.user.is_authenticated %}
                        {% if is_sphere_manager %}
                            <li class="nav-item">
                                <a class="btn btn-outline-light me-2" href="{% url 'panel:index' %}">
                                    <i class="bi bi-speedometer2"></i> {% translate "Panel" %}
                                </a>
                            </li>
                        {% endif %}
                        <li class="nav-item">
                            <a class="btn btn-outline-light me-2"
                               href="{% url 'web:crowd:profile' %}">
                                <i class="bi bi-person-gear"></i> {% translate "Edit Profile" %}
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="btn btn-light me-2" href="{% url 'web:crowd:auth0:logout' %}">
                                <i class="bi bi-box-arrow-right"></i> {% translate "Logout" %}
                            </a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="btn btn-light me-2"" href="{% url 'web:crowd:auth0:login' %}?next={{ request.build_absolute_uri }}">
                                <i class="bi bi-box-arrow-in-right"></i> {% translate "Login" %}
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        {% if messages %}
            <div class="mt-3">
                {% for message in messages %}
                    {% if message.tags == 'error' %}
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <i class="bi bi-exclamation-triangle-fill"></i>
                            {{ message }}
                            <button type="button"
                                    class="btn-close"
                                    data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                    {% elif message.tags == 'warning' %}
                        <div class="alert alert-warning alert-dismissible fade show" role="alert">
                            <i class="bi bi-exclamation-triangle"></i>
                            {{ message }}
                            <button type="button"
                                    class="btn-close"
                                    data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                    {% elif message.tags == 'success' %}
                        <div class="alert alert-success alert-dismissible fade show" role="alert">
                            <i class="bi bi-check-circle-fill"></i>
                            {{ message }}
                            <button type="button"
                                    class="btn-close"
                                    data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                    {% elif message.tags == 'info' %}
                        <div class="alert alert-info alert-dismissible fade show" role="alert">
                            <i class="bi bi-info-circle-fill"></i>
                            {{ message }}
                            <button type="button"
                                    class="btn-close"
                                    data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                    {% else %}
                        <div class="alert alert-secondary alert-dismissible fade show"
                             role="alert">
                            <i class="bi bi-chat-dots"></i>
                            {{ message }}
                            <button type="button"
                                    class="btn-close"
                                    data-bs-dismiss="alert"
                                    aria-label="Close"></button>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endif %}
        <div class="mt-md-4 main-content content-section">
            <!-- Page Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <h1 class="display-5 fw-bold text-center mb-2">
                        {% block header %}
                        {% endblock header %}
                    </h1>
                    <p class="lead text-center text-muted">
                        {% block description %}
                        {% endblock description %}
                    </p>
                </div>
            </div>
            {% block body %}
            {% endblock body %}
        </div>
        <footer class="page-footer py-4">
            <div>
                <div class="row align-items-center">
                    <div class="col-md-6">
                        <p class="mb-0">
                            © 2025 Radosław Ganczarek. <a href="https://github.com/fancysnake/ludamus">Source code</a> available under BSD-3-Clause license.
                        </p>
                    </div>
                    <div class="col-md-6 text-md-end">
                        <a href="mailto:{{ SUPPORT_EMAIL }}" class="text-decoration-none me-3">{% translate "Contact me" %}</a>
                        <a href="{% url 'django.contrib.flatpages.views.flatpage' url='/privacy-policy/' %}"
                           class="text-decoration-none me-3">{% translate "Privacy Policy" %}</a>
                        <a href="{% url 'django.contrib.flatpages.views.flatpage' url='/terms-of-service/' %}"
                           class="text-decoration-none">{% translate "Terms of Service" %}</a>
                    </div>
                </div>
            </div>
        </footer>
        <script src="{% static 'vendor/popper.min.js' %}?v={{ STATIC_VERSION }}"></script>
        <script src="{% static 'vendor/bootstrap.bundle.min.js' %}?v={{ STATIC_VERSION }}"></script>
        <script src="{% static 'vendor/htmx.min.js' %}?v={{ STATIC_VERSION }}"></script>
    </body>
</html>
