{% load i18n %}
{% load heroicons %}
<!-- Modal Overlay -->
<div class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4"
     hx-on:click="if(event.target === this) this.remove()">
    <!-- Modal Content -->
    <div class="bg-white rounded-xl shadow-xl max-w-md w-full"
         hx-on:click.stop="">
        <div class="flex items-center justify-between px-6 py-4 border-b border-gray-100">
            <h3 class="text-lg font-semibold text-gray-900">{% translate "Edit Time Slot" %}</h3>
            <button type="button"
                    hx-on:click="this.closest('#modal-container').innerHTML = ''"
                    class="text-gray-400 hover:text-gray-600 transition">
                {% heroicon_outline "x-mark" class="w-5 h-5" %}
            </button>
        </div>
        <form method="post"
              action="{% url 'panel:timeslot-edit-modal' slug=current_event.slug pk=time_slot.pk %}"
              class="p-6 space-y-4">
            {% csrf_token %}
            {% if form.non_field_errors %}
                <div class="bg-red-50 border border-red-200 text-red-800 rounded-lg p-3 text-sm">
                    {% for error in form.non_field_errors %}{{ error }}{% endfor %}
                </div>
            {% endif %}
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                       for="id_start_time">{% translate "Start Time" %}</label>
                <input type="datetime-local"
                       name="start_time"
                       id="id_start_time"
                       value="{{ time_slot.start_time|date:'Y-m-d\TH:i' }}"
                       class="w-full border {% if form.start_time.errors %}border-red-300{% else %}border-gray-300{% endif %} rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary">
                {% if form.start_time.errors %}<p class="mt-1 text-sm text-red-600">{{ form.start_time.errors.0 }}</p>{% endif %}
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                       for="id_end_time">{% translate "End Time" %}</label>
                <input type="datetime-local"
                       name="end_time"
                       id="id_end_time"
                       value="{{ time_slot.end_time|date:'Y-m-d\TH:i' }}"
                       class="w-full border {% if form.end_time.errors %}border-red-300{% else %}border-gray-300{% endif %} rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary">
                {% if form.end_time.errors %}<p class="mt-1 text-sm text-red-600">{{ form.end_time.errors.0 }}</p>{% endif %}
            </div>
            <div class="flex justify-between items-center pt-4">
                <div>
                    {% if is_used %}
                        {% translate "This time slot is used by proposals and cannot be deleted." as timeslot_used_title %}
                        <span class="text-sm text-gray-500 flex items-center"
                              title="{{ timeslot_used_title }}">
                            {% heroicon_outline "lock-closed" class="w-4 h-4 mr-1" %}
                            {% translate "In use" %}
                        </span>
                    {% else %}
                        <form method="post"
                              action="{% url 'panel:timeslot-delete' slug=current_event.slug pk=time_slot.pk %}"
                              class="inline"
                              onsubmit="return confirm('{% translate "Are you sure you want to delete this time slot?" %}');">
                            {% csrf_token %}
                            <button type="submit"
                                    class="text-red-600 hover:text-red-800 text-sm flex items-center">
                                {% heroicon_outline "trash" class="w-4 h-4 mr-1" %}
                                {% translate "Delete" %}
                            </button>
                        </form>
                    {% endif %}
                </div>
                <div class="flex gap-3">
                    <button type="button"
                            hx-on:click="this.closest('#modal-container').innerHTML = ''"
                            class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition">
                        {% translate "Cancel" %}
                    </button>
                    <button type="submit"
                            class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition">
                        {% translate "Save" %}
                    </button>
                </div>
            </div>
        </form>
    </div>
</div>
